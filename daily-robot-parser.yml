name: Daily Robot Parser

on:
  schedule:
    # –ó–∞–ø—É—Å–∫ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 03:00 UTC (07:00 –ø–æ –°–∞—Ä–∞—Ç–æ–≤—É, GMT+4)
    - cron: '0 3 * * *'

  # –ú–æ–∂–Ω–æ —Ç–∞–∫–∂–µ –∑–∞–ø—É—Å–∫–∞—Ç—å –≤—Ä—É—á–Ω—É—é
  workflow_dispatch:

jobs:
  parse-robots:
    runs-on: ubuntu-latest

    steps:
      - name: ü§ñ Run Rube Recipe - Parse Robots
        run: |
          echo "Starting robot parser..."

          # –í—ã–∑—ã–≤–∞–µ–º Rube Recipe API
          curl -X POST "https://backend.composio.dev/api/v1/actions/rcp_zqcpF4RK7QIv/execute" \
            -H "Content-Type: application/json" \
            -H "x-api-key: ${{ secrets.COMPOSIO_API_KEY }}" \
            -d '{
              "input": {
                "api_key": "${{ secrets.ROBOTS_API_KEY }}",
                "api_url": "https://robototehnika.vercel.app/api/robots",
                "search_mode": "all"
              }
            }' \
            | jq '.'

          echo "‚úÖ Robot parser completed!"

      - name: üìä Show Summary
        run: |
          echo "üéâ Daily robot parsing workflow completed!"
          echo "Check your database at https://robototehnika.vercel.app/api/robots"
